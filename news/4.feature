`listen_for_events` can now be blocking or non-blocking