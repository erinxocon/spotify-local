refactored to use event emiiters!